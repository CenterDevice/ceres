.\" Automatically generated by Pandoc 2.2.1
.\"
.TH "ceres" "1"
.hy
.SH NAME
.PP
CenterDevice SRE (ceres) \[en] Ceres the goddess of agriculture, grain
crops, fertility and motherly relationships.
.SH SYNOPSIS
.PP
ceres [\f[I]options\f[]] \f[I]MODULE\f[]
.PP
mhost \[en]help
.PP
mhost \[en]version
.SH DESCRIPTION
.PP
ceres is a CLI tool for common SRE and ops tasks for CenterDevice.
.PP
ceres comes with different modules.
It supports human readable as well as JSON output for post\-processing
with other tools like \f[C]jq\f[].
.PP
For ceres to work properly \[en] actually to work at all \[en] a
configuration file is required that specifies the stage and its
endpoints as well as required credentials for CenterDevice environments.
See \f[I]ceres.conf\f[] for details.
.PP
The project home page currently
\f[I]https://github.com/lukaspustina/ceres\f[].
.SH COMMON OPTIONS
.TP
.B \[en]config \f[I]config\f[]
Sets config file to use.
Default is \f[I]~/.ceres.conf\f[]
.RS
.RE
.TP
.B \[en]no\-color
Turns off colorful output.
Helpful for non\-tty usage.
.RS
.RE
.TP
.B \[en]profile \f[I]profile\f[]
Sets profile to use.
Default it to use the \f[I]default\f[] profile.
.RS
.RE
.TP
.B \[en]help
Prints help information
.RS
.RE
.SH LESS COMMON OPTIONS
.TP
.B \-V, \[en]version
Prints version information.
.RS
.RE
.SH MODULES
.PP
Currently, there is only one module called \f[I]instances\f[].
.SS CONSUL
.PP
The \f[I]consul\f[] modules interacts with the consul cluster in the
environment selected by the profile to use.
.SS consul list [\f[I]options\f[]]
.PP
\f[I]consul list\f[] shows all currently active nodes and their
services.
Nodes can be filtered by service names and service tags.
The output can be controlled to allow for human readable and plain
format as well as plain or JSON format for post\-processing.
.TP
.B \-o, \[en]output \f[I]output\f[]
Selects output format.
The default is \f[I]human\f[] and the possible values are:
.RS
.PP
human, json, plain
.RE
.TP
.B \[en]output\-options \f[I]output\-options\f[]
Selects the nodes description fields for human and plain output.
The special description field \f[I]MetaData\f[] may take a list of
concrete meta data tags to show.
The corresponding syntax is the same as for \f[I]instance list\f[]
output option's Tag.
There is a shortcut to select all fields by using the field
\f[I]all\f[].
.RS
.RE
.PP
The available description fields are:
.IP
.nf
\f[C]
Id,\ Name,\ MetaData(_),\ Address,\ ServicePort,\ ServiceTags,\ ServiceId,\ ServiceName,\ Healthy
\f[]
.fi
.TP
.B \-s, \[en]services \f[I]services\f[]\&...
Filters services for specific service names.
.RS
.RE
.TP
.B \-t, \[en]tags \f[I]tags\f[]\&...
Filters services for specific tags.
.RS
.RE
.SS INFRASTRUCTURE
.PP
The \f[I]infrastructure\f[] modules automate building, planning, and
deploying infrastructure as code resources from the CenterDevice
\f[I]infrastructure\f[] repository.
.SS infrastructure asp list [\f[I]options\f[]]
.PP
\f[I]infrastructure asp list\f[] identifies all ansible setup packages
(ASPs) in a given sub\-directory of the CenterDevice
\f[I]infrastructure\f[] repository specified either in the ceres
configuration file or passed via command line.
.TP
.B \[en]base\-dir \f[I]base\-dir\f[]
Overwrites base dir from ceres configuration file
.RS
.RE
.TP
.B \-o, \[en]output \f[I]output\f[]
Selects output format.
The default is \f[I]human\f[].
Available options are \f[I]human\f[], \f[I]plain\f[], and \f[I]json\f[].
.RS
.RE
.SS infrastructure asp build [\f[I]options\f[]] \-p \f[I]project\f[] \-r
\f[I]resource\f[]
.PP
\f[I]infrastructure asp build\f[] builds a specifi ansible setup
packages (ASP) and uploads it to S3 in a given sub\-directory of the
CenterDevice \f[I]infrastructure\f[] repository specified either in the
ceres configuration file or passed via command line.
.TP
.B \-p, \[en]project \f[I]project\f[]
Sets project
.RS
.RE
.TP
.B \-r, \[en]resource \f[I]resource\f[]
Sets resource to build
.RS
.RE
.TP
.B \[en]no\-progress\-bar
Do not show progress bar during command execution.
This is useful for non\-interactive sessions.
.RS
.RE
.TP
.B \[en]show\-all
Show all command results.
By default show only results of failed commands.
.RS
.RE
.TP
.B \[en]base\-dir \f[I]base\-dir\f[]
Overwrites base dir from ceres configuration file
.RS
.RE
.TP
.B \-o, \[en]output \f[I]output\f[]
Selects output format.
The default is \f[I]human\f[].
Available options are \f[I]human\f[], \f[I]plain\f[], and \f[I]json\f[].
.RS
.RE
.TP
.B \[en]timeout \f[I]timeout\f[]
Sets the timeout in sec for command to finish.
Default is 300 sec.
.RS
.RE
.SS INSTANCES
.PP
The \f[I]instances\f[] modules interacts with instances in the
environment selected by the profile to use.
.SS instances list [\f[I]options\f[]]
.PP
\f[I]instances list\f[] shows all currently active instances.
Instances can be filtered and the output can be controlled to allow for
human readable, plain, or JSON format for post\-processing.
.TP
.B \-f, \[en]filter \f[I]filter\f[]
Filters instances by description fields.
The filter syntax is \f[I]<description field>=<reg ex>\f[].
Multiple filters can be used and have to be separated by `,'.
Each description field will be matched against the regular expression.
Only instances matching all description field will be selected.
.RS
.RE
.PP
The special description field \f[I]Tags\f[] supports a specialized
syntax which is \f[I]Tags=<tag name>[=<reg ex>]\f[].
Multiple tags can be used and have to be separated by `:'.
If a tag is specified without a regular expressions, only instances
bearing that tag will be selected.
If a tag is specified with a regular expression, only instances bearing
that tag with a matching value will be selected.
Instances have to match all tags to be selected.
.PP
For example, the filter
`InstanceId=i\-.*,Tags=Name:AnsibleHostGroup=batch_.*,State=stopped'
will only selected instances with an instance id beginning in `i\-', the
tag `Name' set, the tag `AnsibleHostGroup' with a value starting in
`batch_' and in the state `stopped' will be selected.
.PP
The available description field to filter against are:
.IP
.nf
\f[C]
BlockDeviceMappings,\ Hypervisor,\ IamInstanceProfile,\ ImageId,\ InstanceId,\ InstanceType,\ LaunchTime,\ Monitoring,\ Placement,\ PrivateDnsName,\ PrivateIpAddress,\ PublicDnsName,\ PublicIpAddress,\ RootDeviceName,\ RootDeviceType,\ SecurityGroups,\ State,\ StateReason,\ Tags(_),\ VirtualizationType,\ VpcId
\f[]
.fi
.TP
.B \-o, \[en]output \f[I]output\f[]
Selects output format.
The default is \f[I]human\f[].
Available options are \f[I]human\f[], \f[I]plain\f[], and \f[I]json\f[].
.RS
.RE
.TP
.B \[en]output\-options \f[I]output\-options\f[]
Selects the instance description fields for human output.
The default is
`InstanceId,InstanceType,State,PrivateIpAddress,PublicIpAddress,LaunchTime'.
The special description field \f[I]Tags\f[] may take a list of concrete
tags to show.
The corresponding syntax is similar to the tags filter and is
\f[I]Tags[=<tag name>]\f[].
Multiple tags can be used have to separated by `:'.
.RS
.RE
.PP
For example, the output options `InstanceId,Tags=Name:AnsibleHostGroup'
outputs the instance id and the tags `Name' and AnsibleHostGroup' for
all selected instances.
.PP
The available options are:
.IP
.nf
\f[C]
BlockDeviceMappings,\ Hypervisor,\ IamInstanceProfile,\ ImageId,\ InstanceId,\ InstanceType,\ LaunchTime,\ Monitoring,\ Placement,\ PrivateDnsName,\ PrivateIpAddress,\ PublicDnsName,\ PublicIpAddress,\ RootDeviceName,\ RootDeviceType,\ SecurityGroups,\ State,\ StateReason,\ Tags(_),\ VirtualizationType,\ VpcId
\f[]
.fi
.SS instances run [\f[I]options\f[]] \f[I]INSTANCE_ID\f[] \&... [\[en]
\f[I]COMMAND_ARGS \&...\f[]]
.PP
\f[I]instances run\f[] connects to multiple instance and runs a single
command on each instance.
By default, the instances' private IP addresses are used.
The remote login name is read from the corresponding profile
configuration in the configuration file, or set as option, or the local
user name is used.
The difference of this command compared to \f[I]instances ssh\f[] is
that this command logs all output to separate files instead of printing
to all output to the console.
.TP
.B \f[I]INSTANCE_ID \&...\f[]
Sets the instance ids to connect to; or `\-' to read json with instance
ids from stdin.
Multiple instance ids may be set.
.RS
.RE
.TP
.B \f[I]COMMAND_ARGS \&...\f[]
Sets the command and its arguments to execute on the remote instance.
These have to be that last argument which requires a prefixing
\f[I]\[en]\f[].
.RS
.RE
.TP
.B \-l, \[en]login\-name \f[I]login\-name\f[]
Sets remote login name
.RS
.RE
.TP
.B \[en]no\-progress\-bar
Do not show progress bar during command execution.
This is useful for non\-interactive sessions.
.RS
.RE
.TP
.B \-p, \[en]public\-ip
Use public IP address of instance
.RS
.RE
.TP
.B \[en]show\-all
Show all command results.
By default show only results of failed commands.
.RS
.RE
.TP
.B \[en]ssh\-opt \f[I]ssh\-opts\f[] \&...
Passes an option to ssh.
This may be used multiple times.
.RS
.RE
.TP
.B \[en]timeout \f[I]timeout\f[]
Sets the timeout in sec for command to finish.
Default is 300 sec.
.RS
.RE
.SS instances ssh [\f[I]options\f[]] \f[I]INSTANCE_ID\f[] [\[en]
\f[I]COMMAND_ARGS \&...\f[]]
.PP
\f[I]instances ssh\f[] connects to an instance and either opens an
interactive shell or runs a single command.
By default, the instance' private IP address is used.
The remote login name is read from the corresponding profile
configuration in the configuration file, or set as option, or the local
user name is used.
.TP
.B \f[I]INSTANCE_ID\f[]
Sets the instance id to connect to.
.RS
.RE
.TP
.B \f[I]COMMAND_ARGS \&...\f[]
Sets the command and its arguments to execute on the remote instance.
These have to be that last argument which requires a prefixing
\f[I]\[en]\f[].
.RS
.RE
.TP
.B \-l, \[en]login\-name \f[I]login\-name\f[]
Sets remote login name
.RS
.RE
.TP
.B \-p, \[en]public\-ip
Use public IP address of instance
.RS
.RE
.TP
.B \[en]ssh\-opt \f[I]ssh\-opts\f[] \&...
Passes an option to ssh.
This may be used multiple times.
.RS
.RE
.SS instances start [\f[I]options\f[]] \f[I]INSTANCE_ID \&...\f[]
.PP
\f[I]instances start\f[] starts instances by instance id and outputs the
corresponding state changes.
The output can be controlled to allow for human readable format or JSON
format for post\-processing.
.TP
.B \f[I]INSTANCE_ID \&...\f[]
Sets the instance id to start; or `\-' to read json with instance ids
from stdin.
Multiple instance ids may be set.
.RS
.RE
.TP
.B \-d, \[en]dry
Activates dry run.
Permissions and instance ids will be checked by AWS, but no instance
will be started.
.RS
.RE
.TP
.B \-o, \[en]output \f[I]output\f[]
Selects output format.
The default is \f[I]human\f[].
Available options are \f[I]human\f[] and \f[I]json\f[].
.RS
.RE
.SS instances stop [\f[I]options\f[]] \f[I]INSTANCE_ID \&...\f[]
.PP
\f[I]instances stop\f[] stops instances by instance id and outputs the
corresponding state changes.
A prompt will ask for confirmation before any instance is stopped.
The output can be controlled to allow for human readable format or JSON
format for post\-processing.
.TP
.B \f[I]INSTANCE_ID \&...\f[]
Sets the instance id to stop; or `\-' to read json with instance ids
from stdin.
Multiple instance ids may be set.
.RS
.RE
.TP
.B \-d, \[en]dry
Activates dry run.
Permissions and instance ids will be checked by AWS, but no instance
will be stopped.
.RS
.RE
.TP
.B \[en]force
Forces instances to stop.
The instances do not have an opportunity to flush file system caches or
file system metadata.
If you use this option, you must perform file system check and repair
procedures.
.RS
.RE
.TP
.B \-o, \[en]output \f[I]output\f[]
Selects output format.
The default is \f[I]human\f[].
Available options are \f[I]human\f[] and \f[I]json\f[].
.RS
.RE
.TP
.B \[en]yes\-i\-really\-really\-mean\-it
Don't ask for confirmation and stop instances immediately.
.RS
.RE
.SS instances terminate [\f[I]options\f[]] \f[I]INSTANCE_ID \&...\f[]
.PP
\f[I]instances terminate\f[] terminates instances by instance id and
outputs the corresponding state changes.
A prompt will ask for confirmation before any termination is executed.
The output can be controlled to allow for human readable format or JSON
format for post\-processing.
.TP
.B \f[I]INSTANCE_ID \&...\f[]
Sets the instance id to terminate; or `\-' to read json with instance
ids from stdin.
Multiple instance ids may be set.
.RS
.RE
.TP
.B \-d, \[en]dry
Activates dry run.
Permissions and instance ids will be checked by AWS, but no instance
will be terminated.
.RS
.RE
.TP
.B \-o, \[en]output \f[I]output\f[]
Selects output format.
The default is \f[I]human\f[].
Available options are \f[I]human\f[] and \f[I]json\f[].
.RS
.RE
.TP
.B \[en]yes\-i\-really\-really\-mean\-it
Don't ask for confirmation and terminate instances immediately.
.RS
.RE
.SS OPS
.PP
The \f[I]ops\f[] modules include various ops related commands to ease
regular ops tasks.
.SS ops asp run [\f[I]options\f[]]
.PP
\f[I]ops asp run\f[] run ASP on multiple instances.
By default, the instances' private IP addresses are used.
The remote login name is read from the corresponding profile
configuration in the configuration file, or set as option, or the local
user name is used.
.TP
.B \-l, \[en]login\-name \f[I]login\-name\f[]
Sets remote login name
.RS
.RE
.TP
.B \[en]no\-progress\-bar
Do not show progress bar during command execution.
This is useful for non\-interactive sessions.
.RS
.RE
.TP
.B \-p, \[en]public\-ip
Use public IP address of instance
.RS
.RE
.TP
.B \[en]show\-all
Show all command results.
By default show only results of failed commands.
.RS
.RE
.TP
.B \[en]ssh\-opt \f[I]ssh\-opts\f[] \&...
Passes an option to ssh.
This may be used multiple times.
.RS
.RE
.TP
.B \[en]timeout \f[I]timeout\f[]
Sets the timeout in sec for command to finish.
Default is 300 sec.
.RS
.RE
.SS ops issues browse [\f[I]options\f[]]
.PP
\f[I]ops issues browse\f[] opens the GitHub ops issues your default web
browser.
.TP
.B \-p, \[en]project
Opens the corresponding ops issues project instead of the issues list.
.RS
.RE
.SS ops issues create [\f[I]options\f[]]
.PP
\f[I]ops issues create\f[] creates a new ops issue either from a file or
using your default \f[I]$EDITOR\f[] pre\-filled from a template.
.TP
.B \[en]browser
Opens new issue in default browser with \f[I]template\f[] from config
setting or set via \f[I]\[en]template\f[].
This setting conflicts with \f[I]\-f\f[] and \f[I]\-i\f[].
.RS
.RE
.TP
.B \-i, \[en]interactive
Opens $EDITOR to write issue contents using \f[I]template\f[] from
config setting or set via \f[I]\[en]template\f[].
This setting conflicts with \f[I]\[en]browser\f[] and \f[I]\-f\f[].
.RS
.RE
.TP
.B \[en]show\-in\-browser
Opens newly created issue in web browser.
.RS
.RE
.TP
.B \[en]no\-wait
Do not wait for editor to finish in interactive mode
.RS
.RE
.TP
.B \-f, \[en]filename \f[I]filename\f[]
Sets file name of markdown file to fill issue with.
This option conflicts with \f[I]\-i\f[].
.RS
.RE
.TP
.B \-l, \[en]label \f[I]label\f[] \&...
Sets labels for new issue.
.RS
.RE
.TP
.B \[en]template \f[I]template\f[]
Uses this template to pre\-fill editor; defaults to config setting.
This option conflicts with \f[I]\-f\f[].
.RS
.RE
.TP
.B \-t, \[en]title \f[I]title\f[]
Sets title for issue.
.RS
.RE
.SS ops webserver backup [\f[I]options\f[]]
.PP
\f[I]ops webserver backup\f[] executes the backup scripts on the
webserver.
All machines with the tag \[lq]Intent=webserver\[rq] are considered
webservers.
By default, the instances' private IP addresses are used.
The remote login name is read from the corresponding profile
configuration in the configuration file, or set as option, or the local
user name is used.
This command assumes that there is only one webserver and refuses to
execute if more than one webservers are found.
This can be overpowered using \f[C]\-\-force\f[]
.TP
.B \-l, \[en]login\-name \f[I]login\-name\f[]
Sets remote login name
.RS
.RE
.TP
.B \[en]no\-progress\-bar
Do not show progress bar during command execution.
This is useful for non\-interactive sessions.
.RS
.RE
.TP
.B \[en]force
Force execution even if more than one webservers are found.
Use this with caution.
.RS
.RE
.TP
.B \-p, \[en]public\-ip
Use public IP address of instance
.RS
.RE
.TP
.B \[en]show\-all
Show all command results.
By default show only results of failed commands.
.RS
.RE
.TP
.B \[en]ssh\-opt \f[I]ssh\-opts\f[] \&...
Passes an option to ssh.
This may be used multiple times.
.RS
.RE
.TP
.B \[en]timeout \f[I]timeout\f[]
Sets the timeout in sec for command to finish.
Default is 300 sec.
.RS
.RE
.SH SHELL COMPLETION
.TP
.B completions \[en]shell \f[I]shell\f[]
Generates shell completions for supported shells which are currently
bash, fish, and zsh.
.RS
.RE
.SH SHOW EXAMPLE CONFIGURATION
.TP
.B show\-example\-config
Show an example configuration file which can be used as a template to
crate a working configuration file.
.RS
.RE
.SH FILES
.PP
\f[I]~/.ceres.conf\f[]
.SH SEE ALSO
.PP
ceres.conf(5)
.SH COPYRIGHT AND LICENSE
.PP
Copyright (c) 2018 Lukas Pustina.
Licensed under the MIT License.
See \f[I]https://github.com/lukaspustina/ceres/blob/master/LICENSE\f[]
for details.
